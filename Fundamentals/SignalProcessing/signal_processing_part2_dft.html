

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Signal Processing (Part 2: Discrete Fourier Transform (DFT)) &#8212; Brain Code Camp</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Fundamentals/SignalProcessing/signal_processing_part2_dft';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Signal Processing (Part 3: Short Time Fourier Transform)" href="signal_processing_part3_STFT.html" />
    <link rel="prev" title="Signal Processing (Part 1: Sampling and Signal Averaging)" href="signal_processing_part1_sampling_averaging.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/braincode101.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/braincode101.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to Brain Code Camp
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Model Selection</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ModelSelection/model_selection_part1_lin_reg_eval_metric.html">Model Selection (Part 1: Simple Linear Model and Evaluation Metric)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ModelSelection/model_selection_part2_poly_overfit_regularization.html">Model Selection (Part 2: Polynomial regression, overfitting, and regularization)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ModelSelection/model_selection_part3_data_splitting.html">Model Selection (Part 3: Training, validation and test data)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Dimensionality Reduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../DimensionalityReduction/dim_reduct_part1_intro.html">Dimensionality Reduction (Part 1: Introduction)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DimensionalityReduction/dim_reduct_part2_pca.html">Dimensionality Reduction (Part 2: Principal Component Analysis)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DimensionalityReduction/dim_reduct_part3_pca_CDT_images.html">Dimensionality Reduction (Part 3: Applying PCA to Clock Drawing Test (CDT) images)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DimensionalityReduction/dim_reduct_part4_nonlinear_methods.html">Dimensionality Reduction (Part 4: Nonlinear Methods)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Signal Processing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="signal_processing_part1_sampling_averaging.html">Signal Processing (Part 1: Sampling and Signal Averaging)</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Signal Processing (Part 2: Discrete Fourier Transform (DFT))</a></li>
<li class="toctree-l1"><a class="reference internal" href="signal_processing_part3_STFT.html">Signal Processing (Part 3: Short Time Fourier Transform)</a></li>
<li class="toctree-l1"><a class="reference internal" href="signal_processing_part4_application.html">Signal Processing (Part 4: Application)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FFundamentals/SignalProcessing/signal_processing_part2_dft.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Fundamentals/SignalProcessing/signal_processing_part2_dft.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Signal Processing (Part 2: Discrete Fourier Transform (DFT))</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="signal-processing-part-2-discrete-fourier-transform-dft">
<h1>Signal Processing (Part 2: Discrete Fourier Transform (DFT))<a class="headerlink" href="#signal-processing-part-2-discrete-fourier-transform-dft" title="Permalink to this heading">#</a></h1>
<p>ใน part 1 เราได้เรียนรู้ว่าเราสามารถศึกษา continuous time signal <span class="math notranslate nohighlight">\(x(t)\)</span> ในทางปฏิบัติได้ ผ่านการเก็บข้อมูล (sampling) มาแค่บางส่วน ถ้าหากเรามี sampling rate ที่สูงพอ ข้อมูล discrete time signal หรือ <span class="math notranslate nohighlight">\(x[n]=x(nT)\)</span> ที่เราเก็บมาจะมีข้อมูลของ <span class="math notranslate nohighlight">\(x(t)\)</span> อย่างครบถ้วน ทำให้เราสามารถทำการวิเคราะห์ <span class="math notranslate nohighlight">\(x[n]\)</span> แทน <span class="math notranslate nohighlight">\(x(t)\)</span> ได้ โดยที่ใช้ทรัพยากรการคำนวณที่มีอยู่อย่างจำกัดได้</p>
<hr class="docutils" />
<p>ในการศึกษา signal ใดๆ หนึ่งในวิธีที่ได้รับความนิยมมาก คือ การดูว่า signal นั้นเกิดจากการเอา signal มีคลื่นความถี่เท่าไหร่มาผสมกันบ้าง ผ่านการใช้ Discrete Fourier Transform (DFT)</p>
<p>กำหนดให้เรามี discrete time signal <span class="math notranslate nohighlight">\(x[n]\)</span> เราสามารถใช้ DFT แปลง <span class="math notranslate nohighlight">\(x[n]\)</span> จาก time domain ให้อยู่ใน frequency domain ได้ โดยเราจะเรียก signal ที่ถูกแปลงค่าว่า <span class="math notranslate nohighlight">\(X[k]\)</span> ซึ่งผลลัพธ์ที่ได้ จะมีโอกาสมีค่าเป็นจำนวนเชิงซ้อน หรือจำนวนจริง ก็ได้</p>
<p>หาก <span class="math notranslate nohighlight">\(X[k]\)</span> มีค่าไม่เท่ากับศูนย์ แปลว่า time signal ที่เรากำลังวิเคราะห์อยู่มี signal ที่มีคลื่นความถี่เท่ากับ <span class="math notranslate nohighlight">\(2π/k\)</span> เป็นส่วนประกอบ</p>
<p>ใน <code class="docutils literal notranslate"><span class="pre">scipy</span></code> เราสามารถคำนวณ DFT ของ signal ใดๆ ด้วยฟังก์ชัน <code class="docutils literal notranslate"><span class="pre">fft</span></code> ตามตัวอย่างด้านล่าง</p>
<p><strong>หมายเหตุ</strong></p>
<ol class="arabic simple">
<li><p>Fast Fourier Transform (FFT) เป็นเทคนิคที่ถูกพัฒนามาเพื่อคำนวณ DFT ได้อย่างรวดเร็ว</p></li>
<li><p>ถึงแม้ว่าใน brainCodeCamp เราจะใช้ FFT ในการแปลง signal จาก time domain ไปสู่ frequency domain แต่จริงๆ แล้ว FFT สามารถใช้ในการแปลง signal จาก domain ตั้งต้นอะไรก็ได้ เช่น ในกรณีของรูปภาพ (2D signal) ซึ่งเราจะเรียกว่าอยู่ใน spatial domain ก็สามารถถูกแปลงไปสู่ spatial frequency domain ได้ผ่านการใช้ FFT</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftfreq</span><span class="p">,</span> <span class="n">ifft</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
</div>
</div>
<p>เตรียมฟังก์ชันไว้สำหรับใช้คำนวณ DFT (ผ่านการใช้ <code class="docutils literal notranslate"><span class="pre">fft</span></code> ของ <code class="docutils literal notranslate"><span class="pre">scipy</span></code>) และแสดงผลลัพธ์ที่เกิดขึ้น</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ฟังก์ชันสำหรับสร้าง time signal ซึ่งเป็นฟังก์ชัน sine ที่มีความถี่ freq, มี sampling period คือ f_s และมีระยะเวลาในแกนเวลาเท่ากับ duration</span>
<span class="k">def</span> <span class="nf">generate_sine_wave</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">f_s</span><span class="p">,</span> <span class="n">duration</span><span class="p">):</span>

  <span class="c1"># คำนวณค่า sampling period (ระยะห่างระหว่างจุดที่เก็บมาสองจุดในแกนเวลา)</span>
  <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">f_s</span> 

  <span class="c1"># คำนวณจำนวนจุดที่มีใน signal</span>
  <span class="n">num_points</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">f_s</span><span class="o">*</span><span class="n">duration</span><span class="p">)</span>
  
  <span class="c1"># สร้างแกนเวลา</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">num_points</span><span class="o">*</span><span class="n">T</span><span class="p">,</span> <span class="n">num_points</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

  <span class="c1"># สร้าง signal x(t) = sin(2*pi*freq*t)</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span>

<span class="k">def</span> <span class="nf">compute_DFT</span><span class="p">(</span><span class="n">x_sampled</span><span class="p">,</span> <span class="n">t_sampled</span><span class="p">,</span> <span class="n">f_s</span><span class="p">,</span> <span class="n">duration</span><span class="p">):</span>

  <span class="c1"># คำนวณจำนวนจุดที่มีใน signal</span>
  <span class="n">num_points</span> <span class="o">=</span> <span class="n">x_sampled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="c1"># ใช้ DFT ในการแปลง</span>
  <span class="n">X_fft</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">x_sampled</span><span class="p">)</span>
  <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">num_points</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">f_s</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">X_fft</span><span class="p">,</span> <span class="n">freq</span>

<span class="k">def</span> <span class="nf">plot_discrete_time_freq_signal</span><span class="p">(</span><span class="n">x_sampled</span><span class="p">,</span> <span class="n">X_fft</span><span class="p">,</span> <span class="n">freq</span><span class="p">):</span>

  <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
  
  <span class="c1"># โดยปกติแล้วเวลาเรากราฟ discrete time signal เราจะใช้ n เป็นแกน x แทนที่จะใช้เวลาจริงในแกน x</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">x_sampled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">x_sampled</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;x[n]&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Discrete time signal x[n] sampled from x(t)&quot;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_fft</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;|X[k]|&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X[k], DFT of x[n]&quot;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="mi">20</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">X_fft</span><span class="p">)))</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Phase of X[k]&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X[k], DFT of x[n]&quot;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="mi">20</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>ทดลองกับกรณีที่ signal เป็นฟังก์ชัน sine ที่มีค่าความถี่เดียว</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq_sine</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># ค่าความถี่ของฟังก์ชัน sine (Hz)</span>
<span class="n">f_s</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1"># อัตราการเก็บข้อมูล หรือ sampling rate (samples/sj หรือ Hz)</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># ระยะเวลาของ signal (s)</span>

<span class="c1"># สร้าง time signal ที่เป็นฟังก์ชัน sine ที่มีความถี่ freq_sine Hz ที่มีค่า sampling rate อยู่ที่ f_s แสดงถึง discrete time signal ที่เก็บมา</span>
<span class="n">x_sampled</span><span class="p">,</span> <span class="n">t_sampled</span> <span class="o">=</span> <span class="n">generate_sine_wave</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="n">freq_sine</span><span class="p">,</span> <span class="n">f_s</span><span class="o">=</span><span class="n">f_s</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>

<span class="c1"># คำนวณ DFT ของ x[n] และ แกน freq สำหรับใช้ plot</span>
<span class="n">X_fft</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">compute_DFT</span><span class="p">(</span><span class="n">x_sampled</span><span class="p">,</span> <span class="n">t_sampled</span><span class="p">,</span> <span class="n">f_s</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>

<span class="c1"># Plot ผลที่ได้</span>
<span class="n">plot_discrete_time_freq_signal</span><span class="p">(</span><span class="n">x_sampled</span><span class="p">,</span> <span class="n">X_fft</span><span class="p">,</span> <span class="n">freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/107d463fd6b26361d29a8de3f7b0a3ada59ab22070b1659ac5cb91dcaae0d32b.png" src="../../_images/107d463fd6b26361d29a8de3f7b0a3ada59ab22070b1659ac5cb91dcaae0d32b.png" />
</div>
</div>
<p>จากตัวอย่างด้านบนจะเห็นได้ว่า DFT ของ signal ด้านบน <span class="math notranslate nohighlight">\(X[k]\)</span> มี peak อยู่ที่ 20 Hz (และ -20 Hz) พอดี โดยที่ไม่มีความถี่อื่นๆ เลย สอดคล้องกับ <span class="math notranslate nohighlight">\(x[n]\)</span> ซึ่งเป็นฟังก์ชัน sine ที่ความถี่ 20 Hz</p>
<p><strong>หมายเหตุ</strong> โดยปกติแล้ว หากเราใช้ sampling rate ที่มีค่าเป็น <span class="math notranslate nohighlight">\(f_s\)</span>
เรามักจะแสดงผลของ DFT โดยกำหนดให้แกน frequency มีค่าความถี่น้อยสุดอยู่ที่ <span class="math notranslate nohighlight">\(-f_s\)</span> และ <span class="math notranslate nohighlight">\(f_s\)</span></p>
<hr class="docutils" />
<p>ต่อไปเรามาลองทดสอบดู signal <span class="math notranslate nohighlight">\(x[n]\)</span> ที่มีค่าความถี่มากกว่า 1 ค่า เช่น</p>
<p><span class="math notranslate nohighlight">\(x[n]\)</span> คือ signal ที่ถูกเก็บข้อมูลมาจาก <span class="math notranslate nohighlight">\(x(t)=sin(2π*20t) + 0.5 sin(2π*50t)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_s</span> <span class="o">=</span> <span class="mi">500</span>

<span class="c1"># สร้าง discrete time signal ที่เป็นฟังก์ชัน sine ที่มีความถี่ 20 Hz</span>
<span class="n">x_sampled_20Hz</span><span class="p">,</span> <span class="n">t_sampled</span> <span class="o">=</span> <span class="n">generate_sine_wave</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">f_s</span><span class="o">=</span><span class="n">f_s</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>

<span class="c1"># สร้าง discrete time signal ที่เป็นฟังก์ชัน sine ที่มีความถี่ 50 Hz และมี amplitude น้อยกว่า</span>
<span class="n">x_sampled_50Hz</span><span class="p">,</span> <span class="n">t_sampled</span> <span class="o">=</span> <span class="n">generate_sine_wave</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">f_s</span><span class="o">=</span><span class="n">f_s</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>

<span class="c1"># สร้าง signal ที่เกิดจากการนำเอา signal ด้านบนทั้งสองตัวมาบวกกัน โดย signal ที่มีความถี่สูงจะถูกลด amplitude มาครึ่งหนึ่ง</span>
<span class="n">x_combined</span> <span class="o">=</span> <span class="n">x_sampled_20Hz</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x_sampled_50Hz</span>

<span class="c1"># คำนวณ DFT ของ signal นี้และแสดงผล</span>
<span class="n">X_fft</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">compute_DFT</span><span class="p">(</span><span class="n">x_combined</span><span class="p">,</span> <span class="n">t_sampled</span><span class="p">,</span> <span class="n">f_s</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="n">plot_discrete_time_freq_signal</span><span class="p">(</span><span class="n">x_combined</span><span class="p">,</span> <span class="n">X_fft</span><span class="p">,</span> <span class="n">freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8832c296c5d43bdebec1e45a1ec71135768cf830de12ac6e2d0bfeee25b64da9.png" src="../../_images/8832c296c5d43bdebec1e45a1ec71135768cf830de12ac6e2d0bfeee25b64da9.png" />
</div>
</div>
<p>จากกราฟด้านบนจะเห็นได้ว่า DFT ของ signal มีคุณสมบัติ ที่สอดคล้องกับ คุณสมบัติของ <span class="math notranslate nohighlight">\(x[n]\)</span> คือ signal ที่ถูกเก็บข้อมูลมาจาก <span class="math notranslate nohighlight">\(x(t)=sin(2π*20t) + 0.5 sin(2π*50t)\)</span> ดังนี้</p>
<ul class="simple">
<li><p>มี peak อยู่ที่ทั้ง 20 Hz และ 50 Hz</p></li>
<li><p>peak ที่ความถี่ 50 Hz มี สูงแค่ครึ่งเดียวของ peak ที่ความถี่ 20 Hz</p></li>
</ul>
<p>ถ้าหากเรามอง signal ในเรา time domain ก็อาจจะบอกได้ยากว่า signal นี้เกิดจากการนำเอา signal ที่มีความถี่เท่าไหร่ มารวมกันบ้าง โดยเฉพาะในกรณีที่ signal เราซับซ้อนมากๆ ซึ่ง DFT ก็เป็นหนึ่งในเทคนิคที่จะมาช่วยเราดูข้อมูลในส่วนนี้ได้</p>
<p>สมมติว่าเราสืบทราบมาว่า signal จากตัวอย่างข้างบน มีที่มาจากสัญญาณสมองที่มีความถี่ไม่เกิน 30 Hz เท่านั้น แต่พอเรามาวิเคราะห์ใน frequency domain เรากลับเจอความถี่ที่ 20 Hz และ 50 Hz</p>
<p>ในการเก็บข้อมูลทาง biomedical เรามักจะพบเจอสัญญาณรบกวนที่เรียกว่า Powerline noise ซึ่งเป็นสัญญาณที่มักมีค่าหลักอยู่ที่ 50 Hz และ 60 Hz ขึ้นอยู่กับสถานที่ที่เราเก็บข้อมูล</p>
<p>เนื่องจากสถานการณ์นี้กำหนดให้เราสนใจสัญญาณสมองที่มีความถี่ไม่เกิน 30 Hz เท่านั้น และ เราพบว่ามีสัญญาณแปลกๆ ที่ค่า 50 Hz ซึ่งคาดการณ์ว่าจะเป็น powerline noise ทำให้เวลาเราจะนำเอา signal นี้ไปวิเคราะห์หรือประมวลผลต่อ เราควรกำจัดสัญญาณรบกวนที่เราเจอที่ 50 Hz ทิ้งไป</p>
<hr class="docutils" />
<p>ในตัวอย่างถัดไป ให้ทดลองลบสัญญาณที่ 50 Hz นี้ โดยการ
ไป</p>
<ol class="arabic simple">
<li><p>แปลงข้อมูลให้ไปอยู่ใน frequency domain โดยการใช้ <code class="docutils literal notranslate"><span class="pre">fft</span></code> (<span class="math notranslate nohighlight">\(X[k]\)</span> = FFT{x[n]}$)</p></li>
<li><p>สร้างฟังก์ชัน <span class="math notranslate nohighlight">\(W[k]\)</span> ที่มีค่าเป็น 0 ตรงค่าความถี่ <span class="math notranslate nohighlight">\(k\)</span> ที่เราต้องการกำจัด และมีค่าเป็น 1 ตรงค่าความถี่ k ที่เราต้องการเก็บไว้ ในที่นี่เราจะเรียก <span class="math notranslate nohighlight">\(W\)</span> ว่าเป็น window หรือ filter</p></li>
<li><p>คำนวนผลลัพธ์ที่โดยการใช้สมการ <span class="math notranslate nohighlight">\(X_{filtered}[k] = X[k]*W[k]\)</span> สำหรับทุกค่า <span class="math notranslate nohighlight">\(k\)</span> เพื่อลบ peak ของ <span class="math notranslate nohighlight">\(X[k]\)</span> ที่ 50 Hz ออกใน frequency domain (ในทางเทคนิค จะเรียกว่า filter ข้อมูลที่ 50 Hz ทิ้งไป)</p></li>
<li><p>แปลง <span class="math notranslate nohighlight">\(X_{filtered}[k]\)</span> ซึ่งเป็นข้อมูลที่ถูก filter แล้วใน frequency domain กลับมาสู่ time domain โดยการคำนวณ Inverse Discrete Fourier Transform (IDFT) ผ่านการเรียกใช้ <code class="docutils literal notranslate"><span class="pre">ifft</span></code> ของ <code class="docutils literal notranslate"><span class="pre">scipy</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_and_plot_filtered_signal</span><span class="p">(</span><span class="n">x_sampled</span><span class="p">,</span> <span class="n">t_sampled</span><span class="p">,</span> <span class="n">f_s</span><span class="p">,</span> <span class="n">duration</span><span class="p">):</span>

  <span class="c1"># Step 1: ใช้ DFT ในการแปลงข้อมูลเข้าสู่ frequency domain</span>
  <span class="n">X_fft</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">compute_DFT</span><span class="p">(</span><span class="n">x_sampled</span><span class="p">,</span> <span class="n">t_sampled</span><span class="p">,</span> <span class="n">f_s</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>

  <span class="c1"># Step 2: สร้าง Window function ใน frequency domain, W[k] โดยในที่นี้จะลองสร้างเป็น window สำหรับ ลบข้อมูลความถี่ที่มีค่ามากกว่า 30 Hz หรือความถี่น้อยกว่า -30 Hz</span>
  <span class="n">W_fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">X_fft</span><span class="p">)</span>
  <span class="n">W_fft</span><span class="p">[(</span><span class="n">freq</span><span class="o">&lt;-</span><span class="mi">30</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">freq</span> <span class="o">&gt;</span><span class="mi">30</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="c1"># Step 3: คำนวณ X[k]*W[k] สำหรับทุกค่า k</span>
  <span class="n">X_fft_filtered</span> <span class="o">=</span> <span class="n">X_fft</span><span class="o">*</span><span class="n">W_fft</span>

  <span class="c1"># Step 4: แปลงค่า X_fft_filtered กลับมาสู่ time domain เพื่อดูผล</span>
  <span class="n">x_filtered</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">X_fft_filtered</span><span class="p">)</span>

  <span class="c1"># ลองแปลงค่า W กลับมาสู่ time domain เช่นกัน</span>
  <span class="n">w</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">W_fft</span><span class="p">)</span>

  <span class="c1"># Plot signal ก่อนและหลังการ filter</span>
  <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>

  <span class="c1"># Plot x[n]</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">x_sampled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">x_sampled</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;x[n]&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Discrete time signal x[n] sampled from x(t)&quot;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

  <span class="c1"># Plot w[n]</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">w</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;w[n]&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Window function to be used for filtering&quot;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

  <span class="c1"># Plot x_filtered[n]</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">x_filtered</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">x_filtered</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Filtered x[n]&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filtered x[n]&quot;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

  <span class="c1"># Plot X[k]</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_fft</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;|X[k]|&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X[k], DFT of x[n]&quot;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="mi">20</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> 

  <span class="c1"># Plot W[k]</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">W_fft</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;|W[k]|&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;W[k], DFT of w[n]&quot;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="mi">20</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> 

  <span class="c1"># Plot X_filtered[k]</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_fft_filtered</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;| Filtered X[k]|&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filtered X[k]&quot;</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="mi">20</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compute_and_plot_filtered_signal</span><span class="p">(</span><span class="n">x_combined</span><span class="p">,</span> <span class="n">t_sampled</span><span class="p">,</span> <span class="n">f_s</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/site-packages/matplotlib/collections.py:192: ComplexWarning: Casting complex values to real discards the imaginary part
  offsets = np.asanyarray(offsets, float)
</pre></div>
</div>
<img alt="../../_images/b745b82b556dcd921d96f6a5232d482e9907b1501c9a876a4ed4f7d5fe61a559.png" src="../../_images/b745b82b556dcd921d96f6a5232d482e9907b1501c9a876a4ed4f7d5fe61a559.png" />
</div>
</div>
<p>จากการสำรวจผลในทั้ง time domain (ภาพซ้ายล่าง) และ ผลใน frequency domain (ภาพขวาล่าง) พบว่าข้อมูลค่าความถี่ 50 Hz ซึ่งเราสันนิษฐานว่าเป็นสัญญาณรบกวน ได้ถูกกำจัดออกไปได้</p>
<p>ในตัวอย่างนี้เราใช้ <span class="math notranslate nohighlight">\(W[k]\)</span> ที่มีค่าเป็น 0 ในบริเวณค่า <span class="math notranslate nohighlight">\(k\)</span> ที่เราต้องการกำจัด และมีค่าเป็น 1 ในบริเวณค่า <span class="math notranslate nohighlight">\(k\)</span> ที่เหลือ ฟังก์ชัน window ที่มีลักษณะแบบนี้มีชื่อเรียกว่า rectangular window เนื่องจากเป็น window ที่มีหน้าตาเหมือนสีเหลี่ยมผืนผ้า (rectangle) นั่นเอง</p>
<p>หากได้มีโอกาสศึกษาเพิ่มเติมจะทราบว่า rectangular window มีข้อจำกัดหลายอย่าง ซึ่งในสถานการณ์จริง มี window อีกหลากหลายประเภทให้เลือกใช้ เช่น Hamming window, Hanning window, Kaiser ฯลฯ (สามารถดูตัวอย่าง window ได้จาก <code class="docutils literal notranslate"><span class="pre">scipy.signal.windows</span></code>) การเลือกใช้ window ก็ขึ้นอยู่กับสถานการณ์การทำงานของเรา</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Fundamentals/SignalProcessing"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="signal_processing_part1_sampling_averaging.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Signal Processing (Part 1: Sampling and Signal Averaging)</p>
      </div>
    </a>
    <a class="right-next"
       href="signal_processing_part3_STFT.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Signal Processing (Part 3: Short Time Fourier Transform)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Brain Code Camp Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>